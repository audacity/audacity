all: @LOCAL_LIBS@ @LIBSRC_BUILD@

# portSMF
portsmf-recursive:
	$(MAKE) -C portsmf
libportSMF.a: portsmf-recursive
	ln -sf portsmf/libportSMF.a libportSMF.a

# FileDialog
FileDialog-recursive:
	$(MAKE) -C FileDialog
FileDialog.a: FileDialog-recursive
	ln -sf FileDialog/FileDialog.a FileDialog.a

# libwidgetextra
widgetextra:
	$(MAKE) -C lib-widget-extra

# libogg
libogg-recursive:
	$(MAKE) -C libogg
libogg.a: libogg-recursive
	ln -sf libogg/src/.libs/libogg.a libogg.a

# libvorbis
libvorbis-recursive:
	$(MAKE) -C libvorbis
libvorbis.a libvorbisfile.a libvorbisenc.a: libogg.a libvorbis-recursive
	ln -sf libvorbis/lib/.libs/libvorbis.a libvorbis.a
	ln -sf libvorbis/lib/.libs/libvorbisfile.a libvorbisfile.a
	ln -sf libvorbis/lib/.libs/libvorbisenc.a libvorbisenc.a

# libflac
libflac-recursive:
	$(MAKE)  -C libflac
libFLAC++.a libFLAC.a: libflac-recursive
	ln -sf libflac/src/libFLAC++/.libs/libFLAC++-static.a libFLAC++.a
	ln -sf libflac/src/libFLAC/.libs/libFLAC-static.a libFLAC.a

# libnyquist
libnyquist-recursive:
	$(MAKE) -C libnyquist
libnyquist.a: libnyquist-recursive
	ln -sf libnyquist/libnyquist.a libnyquist.a

# libvamp
#
# The reason for the "sdkstatic" is that's all that we really need
# and it circumvents an issue when building on OSX...the makefile
# has different options for OSX, but they aren't configurable via
# the configure script.
#
vamp-sdk:
	$(MAKE) -C libvamp sdkstatic
libvamp-hostsdk.a: vamp-sdk
	ln -sf libvamp/libvamp-hostsdk.a libvamp-hostsdk.a

# libtwolame
libtwolame-recursive:
	$(MAKE) -C twolame
libtwolame.a: libtwolame-recursive
	ln -sf twolame/libtwolame/.libs/libtwolame.a libtwolame.a

# libmad
libmad-recursive:
	$(MAKE) -C libmad
libmad.a: libmad-recursive
	ln -sf libmad/.libs/libmad.a libmad.a
libmad/mad.h: libmad-recursive

# libid3tag
libid3tag-recursive:
	$(MAKE) -C libid3tag
libid3tag.a: libid3tag-recursive
	ln -sf libid3tag/.libs/libid3tag.a libid3tag.a

# libsoxr
libsoxr-recursive:
	$(MAKE) -C libsoxr
libsoxr.a: libsoxr-recursive
	ln -sf libsoxr/src/libsoxr.a

# libresample
libresample-recursive:
	$(MAKE) -C libresample libresample.a
libresample.a: libresample-recursive
	ln -sf libresample/libresample.a libresample.a

# libsndfile
libsndfile-recursive:
	$(MAKE) -C libsndfile
libsndfile.a: libsndfile-recursive
	ln -sf libsndfile/src/.libs/libsndfile.a libsndfile.a

# lv2
lv2-recursive:
	$(MAKE) -C lv2
liblv2.a: lv2-recursive
	ln -sf lv2/liblv2.a liblv2.a

# SBSMS
sbsms-recursive:
	$(MAKE) -C sbsms
libsbsms.a: sbsms-recursive
	ln -sf sbsms/src/.libs/libsbsms.a .

# SoundTouch
soundtouch-recursive:
	$(MAKE) -C soundtouch
libSoundTouch.a: soundtouch-recursive
	ln -sf soundtouch/source/SoundTouch/.libs/libSoundTouch.a .

# TagLib
taglib-recursive:
	$(MAKE) -C taglib
taglib.a: taglib-recursive
	ln -sf taglib/taglib/.libs/libtag.a taglib.a 

# PortAudio
portaudio-v19-recursive:
	$(MAKE) -C portaudio-v19 lib/libportaudio.la
libportaudio.a: portaudio-v19-recursive
	ln -sf portaudio-v19/lib/.libs/libportaudio.a libportaudio.a

# PortMixer
portmixer-recursive:
	$(MAKE) -C portmixer
libportmixer.a: portmixer-recursive
	ln -sf portmixer/libportmixer.a libportmixer.a

# Utility rules
clean:
	test ! -f portsmf/Makefile || $(MAKE) -C portsmf clean
	test ! -f FileDialog/Makefile || $(MAKE) -C FileDialog clean
	test ! -f libid3tag/Makefile || $(MAKE) -C libid3tag clean
	test ! -f libmad/Makefile || $(MAKE) -C libmad clean
	test ! -f libnyquist/Makefile || $(MAKE) -C libnyquist clean
	test ! -f libogg/Makefile || $(MAKE) -C libogg clean
	test ! -f libsoxr/Makefile || $(MAKE) -C libsoxr clean
	test ! -f libsamplerate/Makefile || $(MAKE) -C libsamplerate clean
	test ! -f libresample/Makefile || $(MAKE) -C libresample clean
	test ! -f libsndfile/Makefile || $(MAKE) -C libsndfile clean
	test ! -f libvamp/Makefile || $(MAKE) -C libvamp clean
	test ! -f libvorbis/Makefile || $(MAKE) -C libvorbis clean
	test ! -f lib-widget-extra/Makefile || $(MAKE) -C lib-widget-extra clean
	test ! -f libflac/Makefile || $(MAKE) -C libflac clean
	test ! -f lv2/Makefile || $(MAKE) -C lv2 clean
	test ! -f portaudio-v19/Makefile || $(MAKE) -C portaudio-v19 clean
	test ! -f portmixer/Makefile || $(MAKE) -C portmixer clean
	test ! -f sbsms/Makefile || $(MAKE) -C sbsms clean
	test ! -f soundtouch/Makefile || $(MAKE) -C soundtouch clean
	test ! -f twolame/Makefile || $(MAKE) -C twolame clean
	rm -f @LOCAL_LIBS@

distclean:
	test ! -f portsmf/Makefile || $(MAKE) -C portsmf distclean
	test ! -f FileDialog/Makefile || $(MAKE) -C FileDialog distclean
	test ! -f libid3tag/Makefile || $(MAKE) -C libid3tag distclean
	test ! -f libmad/Makefile || $(MAKE) -C libmad distclean
	test ! -f libnyquist/Makefile || $(MAKE) -C libnyquist distclean
	test ! -f libogg/Makefile || $(MAKE) -C libogg distclean
	test ! -f libsoxr/Makefile || $(MAKE) -C libsoxr distclean
	test ! -f libsamplerate/Makefile || $(MAKE) -C libsamplerate distclean
	test ! -f libresample/Makefile || $(MAKE) -C libresample distclean
	test ! -f libsndfile/Makefile || $(MAKE) -C libsndfile distclean
	test ! -f libvamp/Makefile || $(MAKE) -C libvamp distclean
	test ! -f libvorbis/Makefile || $(MAKE) -C libvorbis distclean
	test ! -f lib-widget-extra/Makefile || $(MAKE) -C lib-widget-extra distclean
	test ! -f libflac/Makefile || $(MAKE) -C libflac distclean
	test ! -f lv2/Makefile || $(MAKE) -C lv2 distclean
	test ! -f portaudio-v19/Makefile || $(MAKE) -C portaudio-v19 distclean
	test ! -f portmixer/Makefile || $(MAKE) -C portmixer distclean
	test ! -f sbsms/Makefile || $(MAKE) -C sbsms distclean
	test ! -f soundtouch/Makefile || $(MAKE) -C soundtouch distclean
	test ! -f twolame/Makefile || $(MAKE) -C twolame distclean
	rm -f @LOCAL_LIBS@
	rm -f Makefile

# list here all the targets that aren't actually files to be made
.PHONY: portsmf-recursive FileDialog-recursive \
	widgetextra libogg-recursive \
	libvorbis-recursive libnyquist-recursive libmad-recursive \
	libid3tag-recursive sbsms-recursive soundtouch-recursive libsndfile-recursive \
	libresample-recursive libsoxr-recursive libsamplerate-recursive vamp-sdk \
	portaudio-v19-recursive portmixer-recursive libtwolame-recursive \
	lv2-recursive
